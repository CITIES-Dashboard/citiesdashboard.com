"use strict";(self.webpackChunkfront_end=self.webpackChunkfront_end||[]).push([[914],{1745:function(e,t,n){n.d(t,{Z:function(){return s}});var i=n(4565),r=n(184);function s(e){var t=e.text;return(0,r.jsx)(i.Z,{variant:"h4",color:"text.primary",sx:{fontWeight:"medium",display:"inline-block",textTransform:"uppercase",pb:3,lineHeight:1},children:t})}},4914:function(e,t,n){n.r(t),n.d(t,{default:function(){return Se}});var i=n(885),r=n(1413),s=n(5987),o=n(2791),a=n(5973),l=n(229),c=n(6871),d=n(3540),u=n(1406),x=n(1745),h=n(5152),v=n(5209),f=n(6015),p=n(803),m=n(5953),j=n(4565),Z=n(7205),g=n(1872),b=n(4142),y=n(604),w=n(1478),D=n(501),k=n(4281),C=n(4058),S=n(4853),P=n(3802),I=n(4942),T=n(2797),z=n(5399),Y=n(7248),L=n(5450),O=n(6283),M=n(1680),N=n(9827),_=n(807),B=n(4390),A=n(9773),F=n(1803),E=n(1898),R=n(9022),U=n(324),W=n(4162),H=n(3978),V=n(230),q=n(8821),K=n(1566),Q=n(7170),X=n(5108),G=n(7438),J=n(1009),$=n(7892),ee=n.n($),te=n(277),ne=n(3634),ie=n(1652),re=n(4639),se=n(6767),oe=n(822),ae=n(8928),le=n(3767),ce=n(184),de=["versionDates","day"],ue=(0,te.ZP)(re.H)((function(e){return{"&:after, :hover::after":{content:'"."',fontSize:"1.5rem",bottom:"-0.5rem",position:"absolute",color:e.theme.palette.primary.main,opacity:.5},"&:hover::after":{opacity:1}}}));function xe(e){var t=e.versionDates,n=void 0===t?[]:t,i=e.day,o=(0,s.Z)(e,de);return n.indexOf(ee()(i).format("YYYY-MM-DD"))>=0?(0,ce.jsx)(ue,(0,r.Z)((0,r.Z)({},o),{},{day:i})):(0,ce.jsx)(re.H,(0,r.Z)((0,r.Z)({},o),{},{day:i}))}function he(e){var t=e.smallScreen,n=e.onChange,i=e.versions.filter((function(e){return 10===e.version.length})).map((function(e){return e.version}));return(0,ce.jsx)(le.Z,{onClickAway:function(){return n("close")},children:(0,ce.jsx)(ae.Z,{sx:!t&&{position:"absolute",right:0,zIndex:999},raised:!0,children:(0,ce.jsx)(ie._,{dateAdapter:ne.y,children:(0,ce.jsx)(se.W,{loading:!i,format:"YYYY-MM-DD",renderLoading:function(){return(0,ce.jsx)(oe.e,{})},slots:{day:xe},onChange:function(e,t){return"finish"===t?n(ee()(e).format("YYYY-MM-DD")):null},slotProps:{day:{versionDates:i}},shouldDisableDate:function(e){return t=e,!(i.indexOf(ee()(t).format("YYYY-MM-DD"))>=0);var t},disableHighlightToday:!0,minDate:ee()(i.slice(-1)[0]),maxDate:ee()(i[0])})})})})}function ve(e){var t=e.project,n=(0,o.useContext)(V.N),r=(0,o.useState)(),s=(0,i.Z)(r,2),a=s[0],l=s[1];(0,o.useEffect)((function(){t&&n&&l(n[null===t||void 0===t?void 0:t.id])}),[t,n]);var c=(0,b.Z)(),d=(0,T.Z)(c.breakpoints.down("sm")),u=(0,o.useState)(!1),x=(0,i.Z)(u,2),h=x[0],f=x[1],p=function(){return f(!1)};return(0,ce.jsxs)(ce.Fragment,{children:[(0,ce.jsxs)(Z.Z,{onClick:function(){f(!0),G.y(G.z.rawDatasetButtonClicked,{project_id:t.id})},variant:"contained",children:[(0,ce.jsx)(K.Z,{sx:{fontSize:"1rem"}}),"\xa0Raw Dataset"]}),(0,ce.jsxs)(z.Z,{open:h,onClose:p,maxWidth:"lg",fullWidth:!0,fullScreen:d,keepMounted:!0,children:[d&&(0,ce.jsx)(Y.Z,{sx:{justifyContent:"start"},children:(0,ce.jsxs)(Z.Z,{autoFocus:!0,onClick:p,children:[(0,ce.jsx)(Q.Z,{sx:{fontSize:"1rem"}}),"Back"]})}),(0,ce.jsxs)(L.Z,{children:[(0,ce.jsx)(v.Z,{label:t.title,size:"small",sx:{mb:1}}),(0,ce.jsx)(j.Z,{variant:"h6",children:"Preview and download raw dataset(s)"}),(0,ce.jsx)(fe,{datasets:a,smallScreen:d,project:t}),a&&(0,ce.jsxs)(j.Z,{variant:"caption",sx:{my:2,fontStyle:"italic",display:"block"},children:["This dataset is provided by the CITIES Dashboard with the support of ",t.owner,". Should you intend to utilize this dataset for your project, research, or publication, we kindly request that you notify us at ",(0,ce.jsx)(O.Z,{href:"mailto:nyuad.cities@nyu.edu",children:"nyuad.cities@nyu.edu"})," to discuss citation requirements."]})]})]})]})}var fe=function(e){var t=e.datasets,n=e.smallScreen,s=e.project,a=(0,o.useState)(),l=(0,i.Z)(a,2),c=l[0],d=l[1],u=(0,o.useState)(),x=(0,i.Z)(u,2),h=x[0],v=x[1];return(0,o.useEffect)((function(){var e,n,i,s;(null===t||void 0===t?void 0:t.length)>0&&(d(null===(e=t[0])||void 0===e?void 0:e.versions[0]),v(null===(n=t[0])||void 0===n?void 0:n.id),(0,J.m)(null===(i=t[0])||void 0===i||null===(s=i.versions[0])||void 0===s?void 0:s.rawLink,"csv").then((function(e){var n;d((0,r.Z)((0,r.Z)({},null===(n=t[0])||void 0===n?void 0:n.versions[0]),{},{fetchedDataset:e}))})))}),[t]),(0,ce.jsxs)(m.ZP,{container:!0,justifyContent:"center",alignItems:"start",spacing:3,children:[(0,ce.jsx)(m.ZP,{item:!0,sm:12,md:6,children:(0,ce.jsx)(pe,{datasets:t,smallScreen:n,previewingDataset:c,setPreviewingDataset:d,previewingDatasetId:h,setPreviewingDatasetId:v})}),(0,ce.jsx)(m.ZP,{item:!0,sm:12,md:6,maxWidth:n?"100%":"unset",sx:{mt:1},children:(0,ce.jsx)(je,{previewingDataset:c,previewingDatasetId:h,project:s,smallScreen:n})})]})},pe=function(e){var t=e.datasets,n=e.smallScreen,i=e.previewingDataset,r=e.setPreviewingDataset,s=e.previewingDatasetId,o=e.setPreviewingDatasetId;return(0,ce.jsxs)(M.Z,{size:"small",sx:{tableLayout:"fixed","& td, div, .MuiMenuItem-root":{fontSize:n?"0.625rem":"0.8rem"}},children:[(0,ce.jsx)(N.Z,{children:(0,ce.jsxs)(_.Z,{children:[(0,ce.jsx)(B.Z,{sx:{pl:1},children:"Dataset"}),(0,ce.jsx)(B.Z,{sx:{width:n?"9.5rem":"11rem"},children:"Version"}),(0,ce.jsx)(B.Z,{sx:{width:n?"5rem":"6rem"},children:"Size"})]})}),(0,ce.jsx)(A.Z,{children:null===t||void 0===t?void 0:t.map((function(e){return(0,ce.jsx)(me,{smallScreen:n,dataset:e,previewingDataset:i,setPreviewingDataset:r,isPreviewing:e.id===s,setPreviewingDatasetId:o},e.id)}))})]})},me=function(e){var t=e.smallScreen,n=e.dataset,s=e.setPreviewingDataset,a=e.isPreviewing,l=e.previewingDatasetId,c=e.setPreviewingDatasetId,d=(0,o.useState)({}),u=(0,i.Z)(d,2),x=u[0],v=u[1],f=(null===n||void 0===n?void 0:n.versions[0])||{},p=(0,o.useState)(!1),m=(0,i.Z)(p,2),j=m[0],Z=m[1],g=(0,o.useState)(f),y=(0,i.Z)(g,2),w=y[0],D=y[1],k=null===n||void 0===n?void 0:n.versions.slice(0,3);k.find((function(e){return e===w}))||k.push((0,r.Z)((0,r.Z)({},w),{},{isOlderVersion:!0}));var S=(null===n||void 0===n?void 0:n.versions.length)>3,P=function(e){var t=e.target.value;if("Calendar"!==t){var i=null===n||void 0===n?void 0:n.versions.find((function(e){return e.version===t}));D(i),c(n.id),s(i),z(i)}else Z(!0)},T=function(e){Z(!1),"close"!==e&&P({target:{value:e}})},z=function(e){x[e.version]?s(x[e.version]):(0,J.m)(e.rawLink,"csv").then((function(t){var n=(0,r.Z)((0,r.Z)({},e),{},{fetchedDataset:t});s(n),v((0,r.Z)((0,r.Z)({},x),{},(0,I.Z)({},n.version,n)))}))},Y=function(){l!==n.id&&(c(n.id),s(w),z(w))},L=(0,b.Z)();return(0,ce.jsx)(ce.Fragment,{children:(0,ce.jsxs)(_.Z,{children:[(0,ce.jsx)(B.Z,{sx:{pl:1,cursor:"pointer",background:a&&L.palette.background.NYUpurpleLight},onClick:Y,children:null===w||void 0===w?void 0:w.name}),(0,ce.jsxs)(B.Z,{sx:{position:"relative",background:a&&L.palette.background.NYUpurpleLight},children:[j&&(t?(0,ce.jsx)(F.Z,{open:j,sx:{display:"flex",justifyContent:"center",alignItems:"center"},children:(0,ce.jsx)(he,{onChange:T,smallScreen:t,versions:null===n||void 0===n?void 0:n.versions})}):(0,ce.jsx)(he,{onChange:T,versions:null===n||void 0===n?void 0:n.versions})),(0,ce.jsx)(E.Z,{size:"small",children:(0,ce.jsxs)(R.Z,{value:null===w||void 0===w?void 0:w.version,onClick:function(){n.versions.length<=1&&Y()},onChange:P,variant:"standard",MenuProps:{disablePortal:!0},children:[k.map((function(e,t){return(0,ce.jsx)(U.Z,{value:e.version,sx:[t===k.length-1&&{mb:-.75},e.isOlderVersion&&{marginTop:"1rem","&::before":{content:'""',borderTop:"2px dotted ".concat(L.palette.text.secondary),width:"1rem",height:"1rem",position:"absolute",top:0,left:"50%",transform:"translate(-50%, -50%)"}}],children:(0,ce.jsxs)(W.Z,{direction:"row",alignItems:"center",children:[e.version,e===f&&(0,ce.jsx)(h.Z,{title:"Latest version",enterDelay:0,leaveDelay:200,children:(0,ce.jsx)(H.Z,{sx:{ml:.5,width:"1rem",height:"1rem",background:L.palette.success.main},children:(0,ce.jsx)(C.Z,{sx:{width:"0.8rem",height:"0.8rem"}})})})]})},e.version)})),S&&(0,ce.jsx)(U.Z,{value:"Calendar",sx:{pt:1,mt:1,mb:-.75,borderTop:"0.5px solid"},children:(0,ce.jsxs)(W.Z,{direction:"row",alignItems:"center",children:["Older Versions",(0,ce.jsx)(X.Z,{fontSize:"small",sx:{ml:.5}})]})},"Calendar")]})})]}),(0,ce.jsx)(B.Z,{sx:{background:a&&L.palette.background.NYUpurpleLight},children:function(e){if(e)return e<1048576?(e/1024).toFixed(1)+" KB":(e/1048576).toFixed(1)+" MB"}(null===w||void 0===w?void 0:w.sizeInBytes)})]},n.id)})},je=function(e){var t=e.previewingDataset,n=e.previewingDatasetId,r=e.project,s=e.smallScreen,a="[".concat(r.id,"] ").concat(null===t||void 0===t?void 0:t.name,"-").concat(null===t||void 0===t?void 0:t.version,".csv"),l=(0,b.Z)(),c=(0,o.useState)(""),d=(0,i.Z)(c,2),u=d[0],x=d[1],h=(0,o.useState)(""),v=(0,i.Z)(h,2),p=v[0],m=v[1];return(0,o.useEffect)((function(){if(null!==t&&void 0!==t&&t.fetchedDataset){var e=null===t||void 0===t?void 0:t.fetchedDataset,n=e.split("\n"),i=n.length;if(i<=10)x(e),m(Array.from({length:i},(function(e,t){return t+1})).join("\n"));else{var r=n.slice(0,5),s=n.slice(i-5),o=i-10,a=["... [".concat(o," rows hidden] ...")];x(r.concat(a).concat(s).join("\n")),m(Array.from({length:11},(function(e,t){var n=t+1;return n<6?n:6===n?"":o+n-1})).join("\n"))}}}),[t]),(0,ce.jsxs)(W.Z,{spacing:1,children:[(0,ce.jsxs)(f.Z,{sx:{"& *":{fontFamily:"monospace !important"}},children:[(0,ce.jsx)(W.Z,{direction:"row",children:(0,ce.jsx)(j.Z,{variant:"body2",gutterBottom:!0,fontWeight:600,children:t?"Previewing: ".concat(t.name," (").concat(null===t||void 0===t?void 0:t.version,")"):"Not previewing any dataset"})}),(0,ce.jsx)(f.Z,{component:"pre",sx:{overflowX:"auto",color:l.palette.text.secondary,backgroundColor:l.palette.customBackground,p:2,pt:1.5,borderRadius:l.spacing(1),borderTopLeftRadius:0,minHeight:"5rem",width:s?"100%":"unset",marginTop:0},children:(0,ce.jsxs)(W.Z,{direction:"row",sx:{fontSize:s?"0.625rem !important":"0.8rem !important"},children:[(0,ce.jsx)(f.Z,{sx:{mr:2,userSelect:"none"},children:p}),(0,ce.jsx)(f.Z,{children:u})]})})]}),(0,ce.jsx)(f.Z,{textAlign:"center",children:(0,ce.jsxs)(Z.Z,{variant:"contained",sx:{textTransform:"none",textAlign:"left",lineHeight:1.1,px:1.5,py:1},onClick:function(){!function(){if(null!==t&&void 0!==t&&t.fetchedDataset){var e=new Blob([null===t||void 0===t?void 0:t.fetchedDataset],{type:"application/octet-stream"}),n=URL.createObjectURL(e),i=document.createElement("a");i.href=n,i.download=a,document.body.appendChild(i),i.click(),URL.revokeObjectURL(n),document.body.removeChild(i)}}(),G.y(G.z.rawDatasetDownloaded,{project_id:r.id,dataset_id:n,dataset_name:t.name,dataset_version:t.version})},disabled:!t,children:[(0,ce.jsx)(q.Z,{sx:{fontSize:"1.25rem",mr:.5}}),t?a:"No dataset available to download"]})})]})},Ze=n(1131),ge=n(6344),be=n(2981);var ye=function(e){var t=e.text,n=e.wordLimit,r=void 0===n?60:n,s=e.reference,a=(0,o.useState)(!1),l=(0,i.Z)(a,2),c=l[0],u=l[1],x=(0,b.Z)(),h=(0,T.Z)(x.breakpoints.down("sm")),v=(0,o.useRef)(null),p=t.split(" ");if(!h||p.length/r<=1.4)return(0,ce.jsxs)(f.Z,{children:[(0,ce.jsx)(j.Z,{children:(0,d.ZP)(t,{replace:P.T1})}),s&&(0,ce.jsx)(j.Z,{variant:"caption",color:"text.secondary",children:(0,d.ZP)(s,{replace:P.T1})})]});var m=p.slice(0,r).join(" "),Z=m.lastIndexOf(".");return-1!==Z&&(m=m.slice(0,Z+1)),(0,ce.jsx)(le.Z,{onClickAway:function(e){(function(e){for(var t=e.target,n=v.current.closest(".MuiContainer-root"),i=new Set(["rect","path","svg","circle"]);null!=t;){if(i.has(t.tagName))return t.closest(".MuiContainer-root")===n;t=t.parentNode}return!1})(e)||u(!1)},children:(0,ce.jsx)(f.Z,{ref:v,onClick:function(){return u(!c)},style:{cursor:"pointer"},children:c?(0,ce.jsxs)(ce.Fragment,{children:[(0,ce.jsx)(j.Z,{children:(0,d.ZP)(t,{replace:P.T1})}),s&&(0,ce.jsx)(j.Z,{variant:"caption",color:"text.secondary",children:(0,d.ZP)(s,{replace:P.T1})})]}):(0,ce.jsxs)(ce.Fragment,{children:[(0,ce.jsxs)(j.Z,{display:"inline",children:[(0,d.ZP)(m,{replace:P.T1}),"..."]}),(0,ce.jsx)(j.Z,{display:"inline",color:"text.primary",fontWeight:"500",sx:{ml:.5,"& :hover":{textDecoration:"underline"}},children:"See more"})]})})})},we=n(9132),De=n(8387),ke=["tooltipTitle"],Ce=function(e){var t=e.tooltipTitle,n=(0,s.Z)(e,ke);return(0,ce.jsx)(h.Z,{title:t,enterDelay:0,leaveDelay:200,children:(0,ce.jsx)(v.Z,(0,r.Z)({size:"small"},n))})},Se=function(){var e=(0,c.s0)(),t=(0,o.useContext)(De.x).project,n=(0,o.useContext)(we.p).themePreference,s=(0,o.useContext)(a.F).chartsTitlesList,h=(0,o.useContext)(l.q).tab,v=(0,o.useContext)(V.N),I=(0,o.useState)(null),T=(0,i.Z)(I,2),z=T[0],Y=T[1],L=(0,b.Z)();return(0,o.useEffect)((function(){t&&t.title&&(document.title="".concat(t.title," | CITIES Dashboard"))}),[t]),(0,o.useEffect)((function(){if(t&&v){var e=v[t.id];if(e){var n=e.flatMap((function(e){return e.versions?e.versions[0].version:[]})),i=n.length>0?n.reduce((function(e,t){return e>t?e:t})):null;Y(i)}}}),[v,t]),t?(0,ce.jsxs)(f.Z,{width:"100%",children:[(0,ce.jsx)(ge.Z,{backgroundColor:"customAlternateBackground",children:(0,ce.jsxs)(p.Z,{sx:{pt:5,pb:3},children:[(0,ce.jsx)(x.Z,{text:t.title}),(0,ce.jsxs)(m.ZP,{container:!0,spacing:1,sx:{pb:3,mt:-3},children:[(0,ce.jsx)(m.ZP,{item:!0,children:(0,ce.jsx)(Ce,{icon:(0,ce.jsx)(D.Z,{}),label:t.owner,tooltipTitle:"Dataset Owner"})}),(0,ce.jsx)(m.ZP,{item:!0,children:(0,ce.jsx)(Ce,{icon:(0,ce.jsx)(k.Z,{}),label:t.contact,tooltipTitle:"Contact",component:"a",href:"mailto:".concat(t.contact),clickable:!0})}),(0,ce.jsx)(m.ZP,{item:!0,children:(0,ce.jsx)(Ce,{icon:(0,ce.jsx)(S.Z,{}),label:"".concat(t.charts.length," Chart").concat(t.charts.length>1&&"s"),tooltipTitle:"Number of Charts",onClick:function(){(0,Ze.Qj)(w.O3.id),G.y(G.z.internalNavigation,{destination_id:w.O3.id,destination_label:w.project.toString(),origin_id:"chip"})}})}),z&&(0,ce.jsx)(m.ZP,{item:!0,children:(0,ce.jsx)(Ce,{icon:(0,ce.jsx)(C.Z,{}),label:"Last update: ".concat(z),tooltipTitle:"Last Update"})})]}),(0,ce.jsx)(j.Z,{component:"div",variant:"body1",color:"text.secondary",sx:{textAlign:"justify",pb:3,mb:0,"& table *":{color:"".concat(L.palette.text.secondary)}},gutterBottom:!0,children:t.description?(0,d.ZP)(t.description,{replace:P.T1}):"No project description"}),(0,ce.jsxs)(m.ZP,{container:!0,gap:1,children:[(0,ce.jsx)(ve,{project:t}),t.screen&&(0,ce.jsxs)(Z.Z,{onClick:function(){G.y(G.z.internalNavigation,{destination_id:"/project/".concat(t.id,"/screen"),destination_label:"".concat(t.id," screen"),origin_id:t.id}),e("/project/".concat(t.id,"/screen"))},variant:"contained",children:[(0,ce.jsx)(be.Z,{sx:{fontSize:"1rem"}}),"\xa0TV Screen"]})]})]})}),(0,ce.jsx)(f.Z,{id:w.O3.id,children:t.charts.map((function(e,i){return(0,ce.jsx)(ge.Z,{id:s[i].chartID,backgroundColor:i%2!==0&&"customAlternateBackground",children:(0,ce.jsxs)(p.Z,{sx:{pt:4,pb:4},height:"auto",className:n===y.Z.dark?"dark":"",children:[(0,ce.jsxs)(j.Z,{variant:"h6",color:"text.primary",children:[i+1,". ",e.title]}),(0,ce.jsx)(u.Z,{chartData:(0,r.Z)({chartIndex:i,sheetId:t.sheetId},e)}),(0,ce.jsx)(f.Z,{sx:{my:3},children:(0,ce.jsxs)(j.Z,{component:"div",variant:"body1",color:"text.secondary",sx:{mb:1},children:[e.subtitle&&(0,ce.jsx)(ye,{text:e.subtitle,reference:e.reference?e.reference:void 0}),Number(Object.keys(h)[i])===i&&e.subcharts&&e.subcharts[Object.values(h)[i]].subchartSubtitle&&(0,ce.jsx)(ye,{text:e.subcharts[Object.values(h)[i]].subchartSubtitle,reference:e.subcharts[Object.values(h)[i]].reference?e.subcharts[Object.values(h)[i]].reference:void 0})]})})]})},i)}))}),(0,ce.jsx)(g.Z,{})]}):null}}}]);
//# sourceMappingURL=914.b28e4c26.chunk.js.map